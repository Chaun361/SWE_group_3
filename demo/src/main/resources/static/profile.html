<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile | WEBSITE NAME</title>
    <link rel="stylesheet" href="styles.css"> 
    <link rel="stylesheet" href="profile.css"> 
</head>
<body>

    <header class="main-header">
        <div class="logo">WEBSITE NAME</div>
        <nav class="auth-links" id="header-auth-links">
            </nav>
    </header>

    <main class="container">
        <h1 class="page-title">My Account</h1>

        <div class="profile-content-grid">

            <div class="profile-sidebar">
                <nav>
                    <a href="profile.html" class="sidebar-link active">Profile</a>
                    <a href="order-history.html" class="sidebar-link">Order History</a>
                    <div class="logout-btn-container">
                        <a href="#" id="logout-link" class="sidebar-link logout-link">Logout</a>
                    </div>
                </nav>
            </div>

            <div class="profile-main">
                <div id="profile-container">
                    <h2>Profile Information</h2>
                    <div class="profile-info-display" id="profile-info-display">
                        <p><strong>Full Name:</strong> <span id="full-name">Loading...</span></p>
                        <p><strong>Username:</strong> <span id="username-display">Loading...</span></p>
                        <p><strong>Phone:</strong> <span id="phone-display">Loading...</span></p>
                        <p><strong>Address:</strong> <span id="address-display">Loading...</span></p>
                    </div>

                    </div>
            </div>

        </div>
    </main>
    
    <script>
    const LOGIN_PAGE = 'login.html';
    const MOCK_PROFILE_ENDPOINT = '/mock/mock-profile.json'; // ‡πÉ‡∏ä‡πâ Mock JSON file
    const USER_API = '/api/users/'; // API Path ‡∏ï‡∏≤‡∏° Task

    // ----------------------------------------------------------------
    // 1. HEADER & LOGIN CHECK (Unchanged from Task 5)
    // ----------------------------------------------------------------
    function updateHeader() {
        const username = sessionStorage.getItem('username');
        const isLogin = sessionStorage.getItem('isLogin') === 'true';
        const linksContainer = document.getElementById('header-auth-links');

        linksContainer.innerHTML = ''; 

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏°‡∏µ sessionStorage.username ‡∏Å‡πà‡∏≠‡∏ô render
        if (!isLogin || !username) {
            window.location.href = LOGIN_PAGE; // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ Login
            return false; // return false ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
        }
        
        // Render Logged-in Header
        linksContainer.innerHTML = `
            <a href="order-history.html" class="nav-link">Order History</a>
            <a href="profile.html" class="nav-link">${username}</a>
            <a href="cart.html" class="nav-link cart-icon">üõí</a> 
        `;
        return true;
    }

    // ----------------------------------------------------------------
    // 2. FETCH AND RENDER PROFILE DATA (New Logic for Task 6)
    // ----------------------------------------------------------------
    
    async function fetchAndRenderProfile() {
        const userId = sessionStorage.getItem('userId');
        const displayContainer = document.getElementById('profile-info-display');
        const profileContainer = document.getElementById('profile-container');

        if (!userId) {
            // ‡∏Å‡∏£‡∏ì‡∏µ‡∏´‡∏•‡∏∏‡∏î‡∏£‡∏≠‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Login (‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô)
            displayContainer.innerHTML = '<p style="color: red;">Error: User ID not found in session.</p>';
            return;
        }

        try {
            // **Mock Fetch Logic** (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å GET /api/users/{userId})
            // ‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏à‡∏£‡∏¥‡∏á: const response = await fetch(`${USER_API}${userId}`);
            
            // Mock Scenario: ‡πÑ‡∏°‡πà‡∏û‡∏ö User (‡∏ñ‡πâ‡∏≤ userId ‡πÄ‡∏õ‡πá‡∏ô 000)
            if (userId === '000') {
                 displayContainer.innerHTML = '<p style="color: red;">Error: User not found (Mock 404).</p>';
                 return;
            }

            const response = await fetch(MOCK_PROFILE_ENDPOINT); 
            
            if (!response.ok) {
                // ‡∏´‡∏≤‡∏Å‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Mock ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
                throw new Error('Failed to fetch profile data (Mock)');
            }

            const data = await response.json(); 
            
            // Render ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• JSON ‡∏™‡∏π‡πà Element ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
            document.getElementById('full-name').textContent = data.fullName;
            document.getElementById('username-display').textContent = data.username;
            document.getElementById('phone-display').textContent = data.phone;
            document.getElementById('address-display').textContent = data.userAddress;

        } catch (error) {
            console.error('Profile Fetch Error:', error);
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏ö user
            displayContainer.innerHTML = '<p style="color: red;">Error loading profile data. Please check Mock file or API.</p>';
        }
    }


    document.addEventListener('DOMContentLoaded', () => {
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Login ‡πÅ‡∏•‡∏∞ Render Header
        const loggedIn = updateHeader(); 
        
        if (loggedIn) {
            fetchAndRenderProfile();
        }
        
        // ‡∏õ‡∏∏‡πà‡∏° Logout (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô Task 5)
        const logoutLink = document.getElementById('logout-link');
        if (logoutLink) {
             logoutLink.addEventListener('click', (e) => {
                e.preventDefault(); 
                alert('Logout button clicked (Logic for Task 6:U10 not yet implemented)');
             });
        }
    });
</script> 
</body>
</html>